This is fix for bug1

modified in bug1 branch
